// CV Data
const cvData = {
  "personalInfo": {
    "fullName": "Dr. Atya Mohamed Atya Maraq",
    "title": "Assistant Professor of Media & Communication",
    "subtitle": "Faculty of Arts, Tanta University",
    "email": "Atya.Mohamed@art.tanta.edu.eg",
    "phone": "+20 100 053 4314",
    "address": "25 Al-Jala Street, Al-Hamd Building, Tanta, Gharbia Governorate, Egypt",
    "birthDate": "March 10, 1984",
    "maritalStatus": "Married",
    "profileSummary": "Accomplished media and communication scholar with over 15 years of academic experience. Specialized in public relations, advertising, media translation, and digital communication strategies. Author of 11 published books and active researcher in media studies with focus on social media impact and future trends in communication."
  },
  "education": [
    {
      "degree": "Ph.D. in Media Studies",
      "institution": "Sohag University, Faculty of Arts",
      "year": "2018",
      "specialization": "Public Relations and Tourism Media",
      "thesis": "Elite Attitudes Towards the Future of Public Relations in Egypt During the Next Decade (2015-2025): A Future Study",
      "grade": "First Honor",
      "startDate": "2015",
      "endDate": "2018"
    },
    {
      "degree": "Master's in Media Studies",
      "institution": "Cairo University, Faculty of Media",
      "year": "2014", 
      "specialization": "Public Relations and Advertising",
      "thesis": "The Relationship Between Media Performance During 2010 Parliamentary Elections and Voter Decision: An Applied Study",
      "grade": "Very Good with Honor",
      "startDate": "2008",
      "endDate": "2014"
    },
    {
      "degree": "Master's Preparatory",
      "institution": "Cairo University, Faculty of Media",
      "year": "2008",
      "specialization": "Public Relations and Advertising"
    },
    {
      "degree": "Bachelor of Arts",
      "institution": "Tanta University, Faculty of Arts",
      "year": "2005",
      "specialization": "Media (Public Relations and Advertising Division)",
      "grade": "Very Good with Honor",
      "startDate": "2001",
      "endDate": "2005"
    }
  ],
  "experience": [
    {
      "position": "Lecturer",
      "institution": "Tanta University, Faculty of Arts, Media Department",
      "startDate": "April 2018",
      "endDate": "Present",
      "description": "Teaching undergraduate and graduate courses in media studies, public relations, and advertising. Supervising research projects and thesis work."
    },
    {
      "position": "Assistant Lecturer",
      "institution": "Tanta University, Faculty of Arts, Media Department", 
      "startDate": "May 2014",
      "endDate": "April 2018",
      "description": "Taught various media courses, conducted research, and supported academic activities within the department."
    },
    {
      "position": "Teaching Assistant",
      "institution": "Tanta University, Faculty of Arts, Media Department",
      "startDate": "February 2007",
      "endDate": "May 2014", 
      "description": "Assisted in teaching activities, research support, and administrative duties while pursuing advanced degrees."
    }
  ],
  "publications": [
    "Advertising Strategies through Social Media (2023)",
    "Using Modern Technologies in Media Translation (2023)",
    "Practical Training for Graduation Projects in Public Relations and Advertising (2022)",
    "Talk Shows and Audience Psychology (2022)",
    "Practical Training for Editing Public Relations Materials (2021)",
    "Foundations of Human Relations in Public Relations (2021)",
    "Introduction to Advertising (2020)",
    "Introduction to Media Translation (2019)",
    "Media Texts in English (2019)",
    "Modern Theoretical Approaches in Communication and Media (2019)",
    "Introduction to Public Opinion (2018)"
  ],
  "skills": {
    "technical": [
      {"name": "Microsoft Office Suite", "level": 95},
      {"name": "Digital Communication Platforms", "level": 90},
      {"name": "Social Media Management", "level": 85},
      {"name": "SEO & Digital Marketing", "level": 80},
      {"name": "Online Teaching Platforms", "level": 90},
      {"name": "Research Methodology", "level": 95}
    ],
    "languages": [
      {"name": "Arabic", "level": 100, "note": "Native"},
      {"name": "English", "level": 85, "note": "Advanced"}
    ],
    "academic": [
      {"name": "Public Relations", "level": 95},
      {"name": "Media Studies", "level": 95},
      {"name": "Advertising & Marketing", "level": 90},
      {"name": "Digital Media", "level": 85},
      {"name": "Academic Writing", "level": 90},
      {"name": "Research & Analysis", "level": 95}
    ]
  },
  "certifications": [
    {
      "name": "Innovation in Government Work",
      "issuer": "Mohammed bin Rashid Centre for Government Innovation",
      "platform": "Edraak",
      "year": "2023",
      "description": "4-week course on global methodologies and practical tools for innovation in government sector"
    },
    {
      "name": "Digital Marketing - Paid Digital Campaign Management", 
      "issuer": "Edraak Platform",
      "year": "2023",
      "description": "Fundamentals of digital marketing and creating/managing digital advertising campaigns"
    },
    {
      "name": "Digital Marketing",
      "issuer": "Edraak Platform", 
      "year": "2022",
      "description": "4-week course covering social media platforms, strategic planning for businesses"
    },
    {
      "name": "UX Design", 
      "issuer": "Edraak Platform",
      "year": "2022",
      "description": "Introduction to user experience design and creating products with exceptional UX"
    },
    {
      "name": "First Aid Basic Skills",
      "issuer": "Edraak Platform",
      "year": "2021", 
      "description": "4-week course covering emergency situations and first aid procedures"
    },
    {
      "name": "General English (Pre-Intermediate Level A)",
      "issuer": "Tanta University Language Centre",
      "year": "2017",
      "hours": "36 hours",
      "grade": "85%"
    },
    {
      "name": "English Language Proficiency for PhD",
      "issuer": "Sohag University Language Centre",
      "year": "2017"
    },
    {
      "name": "ICDL - International Computer Driving License",
      "issuer": "UNESCO Accredited",
      "year": "2010"
    }
  ],
  "trainingCourses": [
    {
      "name": "Social Media Usage in Marketing and Advertising",
      "organizer": "Ministry of Education - Main Training Center, Gharbia Governorate",
      "year": "2020",
      "duration": "February 26-30, 2020"
    },
    {
      "name": "Public Relations and Media Skills",
      "organizer": "Ministry of Education - Main Training Center, Gharbia Governorate", 
      "year": "2020",
      "duration": "January 26-30, 2020"
    },
    {
      "name": "Leadership Program in Public Relations",
      "organizer": "General Authority for Information, Gharbia Governorate",
      "year": "2013-2021"
    },
    {
      "name": "Political Awareness and Political Elite During January 25 Revolution",
      "year": "2021"
    },
    {
      "name": "Social Media Risks on Youth",
      "organizer": "Arab Scout Organization, Gharbia Governorate Branch",
      "target": "Secondary school students"
    }
  ],
  "professionalTraining": [
    {
      "name": "University Teacher Preparation Course",
      "organizer": "Faculty of Education, Tanta University",
      "year": "2018",
      "duration": "January 13-27, 2018"
    },
    {
      "name": "Credit Hours System",
      "organizer": "Faculty Development Center, Tanta University",
      "year": "2017"
    },
    {
      "name": "Using Technology in Teaching",
      "organizer": "Faculty Development Center, Tanta University", 
      "year": "2010"
    },
    {
      "name": "Professional Ethics",
      "organizer": "Faculty Development Center, Tanta University",
      "year": "2010"
    },
    {
      "name": "Communication Skills in Different Teaching Patterns",
      "organizer": "Faculty Development Center, Tanta University",
      "year": "2009"
    },
    {
      "name": "Research Ethics",
      "organizer": "International Center for Faculty and Leadership Development, Tanta University",
      "year": "2018"
    },
    {
      "name": "International Scientific Publishing",
      "organizer": "International Center for Faculty and Leadership Development, Tanta University",
      "year": "2018" 
    },
    {
      "name": "Scientific Conference Organization",
      "organizer": "International Center for Faculty and Leadership Development, Tanta University",
      "year": "2018"
    },
    {
      "name": "Effective Presentation Skills", 
      "organizer": "International Center for Faculty and Leadership Development, Tanta University",
      "year": "2018"
    },
    {
      "name": "Time and Meeting Management",
      "organizer": "International Center for Faculty and Leadership Development, Tanta University",
      "year": "2017"
    },
    {
      "name": "Strategic Planning",
      "organizer": "Faculty Development Center, Tanta University",
      "year": "2010"
    }
  ]
};

// DOM Elements - moved to top to ensure they're available
let header, navToggle, navMenu, navLinks, themeToggle, sections, modal, modalOverlay, modalClose, contactForm;

// Initialize DOM elements
function initDOMElements() {
  header = document.getElementById('header');
  navToggle = document.getElementById('nav-toggle');
  navMenu = document.getElementById('nav-menu');
  navLinks = document.querySelectorAll('.nav__link');
  themeToggle = document.getElementById('theme-toggle');
  sections = document.querySelectorAll('section[id]');
  modal = document.getElementById('testimonials-modal');
  modalOverlay = document.getElementById('modal-overlay');
  modalClose = document.getElementById('modal-close');
  contactForm = document.getElementById('contact-form');
}

// Theme Management
class ThemeManager {
  constructor() {
    this.currentTheme = 'light';
    this.init();
  }

  init() {
    // Don't use localStorage to avoid potential issues in sandbox
    this.setTheme('light');
    if (themeToggle) {
      themeToggle.addEventListener('click', () => this.toggleTheme());
    }
  }

  setTheme(theme) {
    this.currentTheme = theme;
    document.documentElement.setAttribute('data-color-scheme', theme);
    if (themeToggle) {
      const icon = themeToggle.querySelector('i');
      if (icon) {
        if (theme === 'dark') {
          icon.className = 'fas fa-sun';
        } else {
          icon.className = 'fas fa-moon';
        }
      }
    }
  }

  toggleTheme() {
    const newTheme = this.currentTheme === 'dark' ? 'light' : 'dark';
    this.setTheme(newTheme);
  }
}

// Navigation Management
class NavigationManager {
  constructor() {
    this.init();
  }

  init() {
    this.setupMobileMenu();
    this.setupSmoothScrolling();
    this.setupScrollSpy();
    this.setupHeaderScroll();
  }

  setupMobileMenu() {
    if (navToggle && navMenu) {
      navToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
        const icon = navToggle.querySelector('i');
        if (icon) {
          if (navMenu.classList.contains('active')) {
            icon.className = 'fas fa-times';
          } else {
            icon.className = 'fas fa-bars';
          }
        }
      });

      // Close mobile menu when clicking on a link
      if (navLinks) {
        navLinks.forEach(link => {
          link.addEventListener('click', () => {
            navMenu.classList.remove('active');
            const icon = navToggle.querySelector('i');
            if (icon) icon.className = 'fas fa-bars';
          });
        });
      }
    }
  }

  setupSmoothScrolling() {
    if (navLinks) {
      navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = link.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          if (targetSection) {
            const offsetTop = targetSection.offsetTop - 70;
            window.scrollTo({
              top: offsetTop,
              behavior: 'smooth'
            });
          }
        });
      });
    }
  }

  setupScrollSpy() {
    if (!sections || sections.length === 0) return;
    
    const observerOptions = {
      threshold: 0.3,
      rootMargin: '-70px 0px -70px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const id = entry.target.getAttribute('id');
        const navLink = document.querySelector(`.nav__link[href="#${id}"]`);
        
        if (entry.isIntersecting) {
          if (navLinks) {
            navLinks.forEach(link => link.classList.remove('active'));
          }
          if (navLink) navLink.classList.add('active');
        }
      });
    }, observerOptions);

    sections.forEach(section => observer.observe(section));
  }

  setupHeaderScroll() {
    if (header) {
      window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });
    }
  }
}

// Animation Manager
class AnimationManager {
  constructor() {
    this.init();
  }

  init() {
    this.setupIntersectionObserver();
  }

  setupIntersectionObserver() {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          if (entry.target.classList.contains('timeline-item')) {
            entry.target.classList.add('animate');
          }
          if (entry.target.classList.contains('skill-item')) {
            entry.target.classList.add('animate');
          }
        }
      });
    }, observerOptions);

    // Wait for timeline items and skill items to be created
    setTimeout(() => {
      document.querySelectorAll('.timeline-item, .skill-item').forEach(item => {
        observer.observe(item);
      });
    }, 500);
  }
}

// Data Population Manager
class DataManager {
  constructor() {
    this.init();
  }

  init() {
    // Wait a bit to ensure DOM is ready
    setTimeout(() => {
      this.populateEducation();
      this.populateExperience();
      this.populateSkills();
      this.populatePublications();
      this.populateCertifications();
    }, 100);
  }

  populateEducation() {
    const timeline = document.getElementById('education-timeline');
    if (!timeline) {
      console.error('Education timeline container not found');
      return;
    }
    
    timeline.innerHTML = ''; // Clear existing content
    
    cvData.education.forEach((edu, index) => {
      const timelineItem = document.createElement('div');
      timelineItem.className = 'timeline-item';
      
      timelineItem.innerHTML = `
        <div class="timeline-date">${edu.year}</div>
        <div class="timeline-content">
          <h3 class="timeline-title">${edu.degree}</h3>
          <h4 class="timeline-subtitle">${edu.institution}</h4>
          ${edu.specialization ? `<p><strong>Specialization:</strong> ${edu.specialization}</p>` : ''}
          ${edu.thesis ? `<p><strong>Thesis:</strong> ${edu.thesis}</p>` : ''}
          ${edu.grade ? `<p><strong>Grade:</strong> ${edu.grade}</p>` : ''}
        </div>
      `;
      
      timeline.appendChild(timelineItem);
    });
  }

  populateExperience() {
    const timeline = document.getElementById('experience-timeline');
    if (!timeline) {
      console.error('Experience timeline container not found');
      return;
    }
    
    timeline.innerHTML = ''; // Clear existing content
    
    cvData.experience.forEach((exp, index) => {
      const timelineItem = document.createElement('div');
      timelineItem.className = 'timeline-item';
      
      const dateRange = `${exp.startDate} - ${exp.endDate}`;
      
      timelineItem.innerHTML = `
        <div class="timeline-date">${dateRange}</div>
        <div class="timeline-content">
          <h3 class="timeline-title">${exp.position}</h3>
          <h4 class="timeline-subtitle">${exp.institution}</h4>
          <p class="timeline-description">${exp.description}</p>
        </div>
      `;
      
      timeline.appendChild(timelineItem);
    });
  }

  populateSkills() {
    this.populateSkillCategory('technical-skills', cvData.skills.technical);
    this.populateSkillCategory('academic-skills', cvData.skills.academic);
    this.populateSkillCategory('language-skills', cvData.skills.languages);
  }

  populateSkillCategory(containerId, skills) {
    const container = document.getElementById(containerId);
    if (!container) {
      console.error(`Skills container ${containerId} not found`);
      return;
    }
    
    container.innerHTML = ''; // Clear existing content
    
    skills.forEach(skill => {
      const skillItem = document.createElement('div');
      skillItem.className = 'skill-item';
      
      skillItem.innerHTML = `
        <div class="skill-header">
          <span class="skill-name">${skill.name}${skill.note ? ` (${skill.note})` : ''}</span>
          <span class="skill-percentage">${skill.level}%</span>
        </div>
        <div class="skill-bar">
          <div class="skill-progress" style="--skill-width: ${skill.level}%"></div>
        </div>
      `;
      
      container.appendChild(skillItem);
    });
  }

  populatePublications() {
    const grid = document.getElementById('publications-grid');
    if (!grid) {
      console.error('Publications grid not found');
      return;
    }
    
    grid.innerHTML = ''; // Clear existing content
    
    cvData.publications.forEach((publication, index) => {
      const year = publication.match(/\((\d{4})\)$/)?.[1] || '2023';
      const title = publication.replace(/\s*\(\d{4}\)$/, '');
      
      const publicationItem = document.createElement('div');
      publicationItem.className = 'publication-item';
      
      publicationItem.innerHTML = `
        <div class="publication-icon">
          <i class="fas fa-book"></i>
        </div>
        <h3 class="publication-title">${title}</h3>
        <p class="publication-year">${year}</p>
      `;
      
      grid.appendChild(publicationItem);
    });
  }

  populateCertifications() {
    this.populateCertificationTab('certifications-grid', cvData.certifications);
    this.populateCertificationTab('training-grid', cvData.trainingCourses);
    this.populateCertificationTab('professional-grid', cvData.professionalTraining);
  }

  populateCertificationTab(containerId, items) {
    const container = document.getElementById(containerId);
    if (!container) {
      console.error(`Certification container ${containerId} not found`);
      return;
    }
    
    container.innerHTML = ''; // Clear existing content
    
    items.forEach(item => {
      const certItem = document.createElement('div');
      certItem.className = 'certification-item';
      
      certItem.innerHTML = `
        <h3 class="certification-name">${item.name}</h3>
        <p class="certification-issuer">${item.issuer || item.organizer}</p>
        <p class="certification-year">${item.year}</p>
        ${item.description ? `<p class="certification-description">${item.description}</p>` : ''}
        ${item.duration ? `<p class="certification-description">${item.duration}</p>` : ''}
        ${item.hours ? `<p class="certification-description">${item.hours}</p>` : ''}
        ${item.grade ? `<p class="certification-description">Grade: ${item.grade}</p>` : ''}
      `;
      
      container.appendChild(certItem);
    });
  }
}

// Tab Manager
class TabManager {
  constructor() {
    this.init();
  }

  init() {
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const targetTab = button.getAttribute('data-tab');
        
        // Remove active class from all buttons and contents
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        
        // Add active class to clicked button and corresponding content
        button.classList.add('active');
        const targetContent = document.getElementById(`${targetTab}-tab`);
        if (targetContent) {
          targetContent.classList.add('active');
        }
      });
    });
  }
}

// Modal Manager
class ModalManager {
  constructor() {
    this.init();
  }

  init() {
    // Listen for testimonials button clicks
    document.addEventListener('click', (e) => {
      if (e.target.closest('[data-modal="testimonials"]')) {
        e.preventDefault();
        this.openModal();
      }
    });

    if (modalOverlay) {
      modalOverlay.addEventListener('click', () => this.closeModal());
    }
    
    if (modalClose) {
      modalClose.addEventListener('click', () => this.closeModal());
    }
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal && modal.classList.contains('active')) {
        this.closeModal();
      }
    });
  }

  openModal() {
    if (modal) {
      modal.classList.remove('hidden');
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
  }

  closeModal() {
    if (modal) {
      modal.classList.remove('active');
      document.body.style.overflow = '';
      setTimeout(() => {
        modal.classList.add('hidden');
      }, 300);
    }
  }
}

// Form Manager
class FormManager {
  constructor() {
    this.init();
  }

  init() {
    if (contactForm) {
      contactForm.addEventListener('submit', (e) => this.handleSubmit(e));
    }
  }

  handleSubmit(e) {
    const data = {
      name: document.getElementById('name')?.value || '',
      email: document.getElementById('email')?.value || '',
      subject: document.getElementById('subject')?.value || '',
      message: document.getElementById('message')?.value || ''
    };

    // Basic validation
    if (!this.validateForm(data)) {
      e.preventDefault();
      return;
    }

    // Show submission message
    this.showSubmissionMessage();
  }

  validateForm(data) {
    const { name, email, subject, message } = data;
    
    if (!name.trim() || !email.trim() || !subject.trim() || !message.trim()) {
      alert('Please fill in all fields.');
      return false;
    }

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      alert('Please enter a valid email address.');
      return false;
    }

    return true;
  }

  showSubmissionMessage() {
    const submitBtn = contactForm.querySelector('button[type="submit"]');
    if (submitBtn) {
      const originalText = submitBtn.innerHTML;
      
      submitBtn.innerHTML = '<i class="fas fa-check"></i> Message Sent!';
      submitBtn.style.backgroundColor = 'var(--color-success)';
      submitBtn.disabled = true;
      
      setTimeout(() => {
        submitBtn.innerHTML = originalText;
        submitBtn.style.backgroundColor = '';
        submitBtn.disabled = false;
      }, 3000);
    }
  }
}

// Testimonials button functionality
function addTestimonialsButton() {
  const aboutSection = document.querySelector('.about .container');
  if (aboutSection) {
    // Remove existing button if it exists
    const existingBtn = aboutSection.querySelector('[data-modal="testimonials"]');
    if (existingBtn) {
      existingBtn.parentElement.remove();
    }
    
    const testimonialsBtn = document.createElement('div');
    testimonialsBtn.style.textAlign = 'center';
    testimonialsBtn.style.marginTop = 'var(--space-32)';
    testimonialsBtn.innerHTML = `
      <button class="btn btn--outline" data-modal="testimonials">
        <i class="fas fa-quote-left"></i> View Testimonials
      </button>
    `;
    aboutSection.appendChild(testimonialsBtn);
  }
}

// Scroll to top functionality
function addScrollToTop() {
  // Remove existing scroll button if it exists
  const existingBtn = document.getElementById('scroll-to-top');
  if (existingBtn) {
    existingBtn.remove();
  }
  
  const scrollBtn = document.createElement('button');
  scrollBtn.id = 'scroll-to-top';
  scrollBtn.innerHTML = '<i class="fas fa-arrow-up"></i>';
  scrollBtn.style.cssText = `
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 50px;
    height: 50px;
    background: var(--cv-primary);
    color: white;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
    box-shadow: var(--shadow-lg);
  `;
  
  document.body.appendChild(scrollBtn);
  
  window.addEventListener('scroll', () => {
    if (window.pageYOffset > 300) {
      scrollBtn.style.opacity = '1';
      scrollBtn.style.visibility = 'visible';
    } else {
      scrollBtn.style.opacity = '0';
      scrollBtn.style.visibility = 'hidden';
    }
  });
  
  scrollBtn.addEventListener('click', () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });
}

// Print styles optimization
function optimizeForPrint() {
  // Remove existing print styles if they exist
  const existingStyles = document.querySelector('#print-styles');
  if (existingStyles) {
    existingStyles.remove();
  }
  
  const printStyles = document.createElement('style');
  printStyles.id = 'print-styles';
  printStyles.textContent = `
    @media print {
      .header, .nav__toggle, .theme-toggle, .modal, #scroll-to-top {
        display: none !important;
      }
      
      body {
        padding-top: 0 !important;
        font-size: 12px !important;
      }
      
      .hero {
        min-height: auto !important;
        page-break-after: avoid;
      }
      
      .section {
        page-break-inside: avoid;
        padding: 20px 0 !important;
      }
      
      .timeline-item, .skill-item, .publication-item, .certification-item {
        page-break-inside: avoid;
        margin-bottom: 15px !important;
      }
      
      .hero__actions, .contact__form {
        display: none !important;
      }
      
      a {
        color: black !important;
        text-decoration: underline !important;
      }
    }
  `;
  document.head.appendChild(printStyles);
}

// Initialize Application
function initializeApp() {
  // Initialize DOM elements first
  initDOMElements();
  
  // Initialize all managers
  const themeManager = new ThemeManager();
  const navigationManager = new NavigationManager();
  const dataManager = new DataManager();
  const animationManager = new AnimationManager();
  const tabManager = new TabManager();
  const modalManager = new ModalManager();
  const formManager = new FormManager();
  
  // Add additional functionality
  setTimeout(() => {
    addTestimonialsButton();
    addScrollToTop();
    optimizeForPrint();
  }, 200);
  
  console.log('CV Website initialized successfully');
}

// Wait for DOM to be ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeApp);
} else {
  initializeApp();
}

// Add smooth reveal animations on load
window.addEventListener('load', () => {
  const elements = document.querySelectorAll('.hero__content > *');
  elements.forEach((el, index) => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(30px)';
    setTimeout(() => {
      el.style.transition = 'all 0.6s ease';
      el.style.opacity = '1';
      el.style.transform = 'translateY(0)';
    }, index * 100);
  });
});

// Performance optimization: Lazy load non-critical animations
const lazyAnimations = () => {
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '50px'
  };
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.transition = 'all 0.6s ease';
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);
  
  // Wait for elements to be created
  setTimeout(() => {
    document.querySelectorAll('.card, .publication-item, .certification-item').forEach(el => {
      el.style.opacity = '0';
      el.style.transform = 'translateY(20px)';
      observer.observe(el);
    });
  }, 500);
};

// Initialize lazy animations
setTimeout(lazyAnimations, 500);